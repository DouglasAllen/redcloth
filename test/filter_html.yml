---
name: standalone html escaped
in: |-
  <hr>
  <abc def="a=1&b=2">
  <div>
  <hr/>
  <hr />
  </div>
filtered_html: |-
  &lt;hr&gt;
  &lt;abc def=&quot;a=1&amp;b=2&quot;&gt;
  &lt;div&gt;
  &lt;hr/&gt;
  &lt;hr /&gt;
  &lt;/div&gt;
---
in:  Just a little harmless xss <script src=http://ha.ckers.org/xss.js></script>
filtered_html: <p>Just a little harmless xss &lt;script src=http://ha.ckers.org/xss.js&gt;&lt;/script&gt;</p>
---
name: filter_html processes text beginning with space
in: ' This should be <b>escaped</b>: <script type="text/javascript">alert("Hai. I`m in ya PC. Makin ya XSS viruzz! KThxBye");</script>'
filtered_html: 'This should be &lt;b&gt;escaped&lt;/b&gt;: &lt;script type=&quot;text/javascript&quot;&gt;alert("Hai. I`m in ya PC. Makin ya XSS viruzz! KThxBye");&lt;/script&gt;'
---
name: filter_html processes script tags beginning with space
in: ' <script type="text/javascript">alert("Hai. I`m in ya PC. Makin ya XSS viruzz! KThxBye");</script>'
filtered_html: '&lt;script type=&quot;text/javascript&quot;&gt;alert("Hai. I`m in ya PC. Makin ya XSS viruzz! KThxBye");&lt;/script&gt;'
---
name: filter_html processes text in notextile tags
in: |-
  <notextile>
  This should be <b>escaped</b>: <script type="text/javascript">alert("Hai. I`m in ya PC. Makin ya XSS viruzz! KThxBye");</script>
  </notextile>
filtered_html: |-
  This should be &lt;b&gt;escaped&lt;/b&gt;: &lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;Hai. I`m in ya PC. Makin ya XSS viruzz! KThxBye&quot;);&lt;/script&gt;
---
name: filter_html escapes script tags
in: |-
  <script type="text/javascript">
    alert("Hai. I`m in ya PC. Makin ya XSS viruzz! KThxBye");
  </script>
filtered_html: |-
  &lt;script type=&quot;text/javascript&quot;&gt;
    alert("Hai. I`m in ya PC. Makin ya XSS viruzz! KThxBye");
  &lt;/script&gt;
---
name: filter_html escapes inline html tags
in: |-
  p. Letting people inject their own HTML can be <em>dangerous</em>!.
filtered_html: |-
  <p>Letting people inject their own <span class="caps">HTML</span> can be &lt;em&gt;dangerous&lt;/em&gt;!.</p>
---
in: Here's a bad image <img src="JaVaScRiPt:alert('XSS');">
filtered_html: <p>Here&#8217;s a bad image &lt;img src=&quot;JaVaScRiPt:alert(&#8217;XSS&#8217;);&quot;&gt;</p>
---
in: Just some random > and < characters, but also a <br/> tag.
filtered_html: <p>Just some random &gt; and &lt; characters, but also a &lt;br/&gt; tag.</p>
---
in: |-
  Quotes outside "pre" tags are escaped.
  
  <a href="test">Tags are completely escaped outside pre tags.</a>

  <pre>
  <code>
    # only < and > are escaped inside pre tags.  "Quotes" remain.

    <div>
      a = 1
    </div>

    Bad code here.

    <script language="JavaScript">
      window.open( "abfiltered_html:blank" );
    </script>
  </code>
  </pre>

filtered_html: |-
  <p>Quotes outside &#8220;pre&#8221; tags are escaped.</p>
  <p>&lt;a href=&quot;test&quot;&gt;Tags are completely escaped outside pre tags.&lt;/a&gt;</p>
  <pre>
  <code>
    # only &lt; and &gt; are escaped inside pre tags.  "Quotes" remain.

    &lt;div&gt;
      a = 1
    &lt;/div&gt;

    Bad code here.

    &lt;script language="JavaScript"&gt;
      window.open( "abfiltered_html:blank" );
    &lt;/script&gt;
  </code>
  </pre>
---
in: /me <3 beer
filtered_html: <p>/me &lt;3 beer</p>
